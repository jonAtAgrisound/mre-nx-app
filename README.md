# Minimal Reproducible Example: Firebase App Hosting + Nx Monorepo + Next.js Standalone

This repository demonstrates an issue encountered when deploying a Next.js application (configured with `output: 'standalone'`) from an Nx monorepo to Firebase App Hosting.

## Issue

The Firebase App Hosting build process fails during the "pack" phase with an `ENOENT` error, unable to find `middleware-manifest.json` at an expected path. This seems to be due to how the `@apphosting/adapter-nextjs` resolves paths within the build output generated by `@nx/next:build`.

The Nx build output places the runnable standalone application at `dist/apps/web/.next/standalone/apps/web/`. The Firebase adapter appears to look for files relative to `dist/apps/web/` using an incorrect nested path.

## Steps to Reproduce Locally (to see build output)

1.  Clone this repository.
2.  Install dependencies:
    ```bash
    npm install
    ```
3.  Build the Next.js application:
    ```bash
    npx nx build web
    ```
4.  Inspect the build output in `dist/apps/web/`. Note the location of `server.js` and `middleware-manifest.json` within `dist/apps/web/.next/standalone/apps/web/`.

## Steps to Reproduce Firebase Deployment Issue

1.  Set up a Firebase project with App Hosting enabled.
2.  Connect this repository to a new App Hosting backend.
3.  Attempt to deploy. The build should succeed for the Next.js app (`@nx/next:build`), but the subsequent Firebase "pack" step will fail with the `ENOENT` error for `middleware-manifest.json`.

